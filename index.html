<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ìƒíƒœì•Œë¼ë¯¸ v6.3</title>
<style>
    :root {
        --bg-color: #f0f2f5;
        --text-color: #333333;
        --accent-color: #5865F2;
        --custom-color: #2ecc71;
        --card-bg: #ffffff;
        --border-radius: 16px;
    }

    body.dark-mode {
        --bg-color: #1e1f22;
        --text-color: #dbdee1;
        --card-bg: #2b2d31;
    }

    body {
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
        margin: 0;
        padding: 20px;
        transition: 0.3s;
    }

    /* ë©”ì¸ íƒ€ì´í‹€ ì˜ì—­ */
    .header-area {
        text-align: center;
        margin-top: 40px;
        margin-bottom: -10px;
    }
    .header-area h1 {
        font-size: 2.2rem;
        color: var(--accent-color);
        margin-bottom: 5px;
        letter-spacing: -1px;
    }
    .header-area .developer {
        font-size: 0.9rem;
        color: #888;
        font-weight: 500;
    }

    h2 { margin-top: 0; font-size: 1.4rem; color: var(--accent-color); margin-bottom: 20px; }

    .main-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        max-width: 1400px;
        margin: 40px auto;
        justify-content: center;
        align-items: stretch;
    }

    .grid-column {
        flex: 1 1 350px;
        display: flex;
        flex-direction: column;
    }

    .card {
        background: var(--card-bg);
        border-radius: var(--border-radius);
        padding: 25px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        height: 100%;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
    }

    input {
        width: 100%;
        padding: 12px;
        margin: 10px 0;
        border-radius: 10px;
        border: 1px solid #ddd;
        box-sizing: border-box;
        outline: none;
        font-size: 14px;
    }
    .timer-input { width: 100px; display: inline-block; background-color: #fffbe6; margin-right: 5px; }

    button {
        padding: 10px 12px;
        margin: 3px;
        font-size: 13px;
        cursor: pointer;
        border-radius: 8px;
        border: none;
        background-color: #f1f3f5;
        transition: 0.2s;
    }
    button:hover { background-color: #e9ecef; transform: translateY(-2px); }
    .btn-primary { background-color: var(--accent-color); color: white; }
    .btn-success { background-color: var(--custom-color); color: white; }
    .btn-back { background-color: #d1d8ff !important; font-weight: bold; width: 100%; margin: 15px 0 0 0; font-size: 15px; padding: 15px; }

    .time-chip { background-color: #ffeaa7; border: 1px solid #fdcb6e; font-weight: 600; }
    .time-chip:hover { background-color: #fab1a0; }

    #status-display {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        padding-top: 20px;
    }
    .status-icon { font-size: 5.5rem; margin-bottom: 25px; }
    #display-text { font-size: 1.5rem; font-weight: bold; line-height: 1.6; text-align: center; }
    #countdown-display { font-size: 1.5rem; color: #e74c3c; margin-top: 25px; font-weight: 800; background: #fff5f5; padding: 10px 20px; border-radius: 30px; }

    #status-history {
        max-height: 250px;
        overflow-y: auto;
        text-align: left;
        background: #f9f9f9;
        padding: 10px;
        border-radius: 8px;
        margin-top: 10px;
        flex-grow: 1;
    }
    .dark-mode #status-history { background: #35373c; }
    .history-item { padding: 8px; border-bottom: 1px solid #eee; font-size: 0.85rem; }

    .warning-box {
        background-color: #fff5f5;
        border-left: 4px solid #ff8787;
        padding: 12px;
        margin-top: 15px;
        font-size: 0.8rem;
        text-align: left;
        color: #e03131;
    }
    .dark-mode .warning-box { background-color: #3b2525; color: #ffc9c9; }

    .theme-btn { position: fixed; top: 20px; right: 20px; background-color: var(--accent-color); color: white; width: 45px; height: 45px; border-radius: 50%; z-index: 1000; }

    @media (max-width: 1100px) {
        .main-grid { flex-direction: column; }
        .grid-column { min-height: auto; }
        .header-area { margin-top: 60px; }
    }
</style>
</head>
<body>

<button class="theme-btn" onclick="toggleTheme()">ğŸŒ“</button>

<div class="header-area">
    <h1>ğŸ“¡ ë””ìŠ¤ì½”ë“œ ìƒíƒœì•Œë¼ë¯¸ v6.3</h1>
    <div class="developer">Developer by. ê¹€ìœ¤ê²¸</div>
</div>

<div class="main-grid">

    <div class="grid-column">
        <div class="card">
            <h2>ğŸ‘¤ ë‚´ ì„¤ì •</h2>
            <input type="text" id="nickname" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”" oninput="saveNickname()">

            <div style="margin-top: 20px;">
                <strong>â± ë³µê·€ ì‹œê°„ ì„ íƒ (ë¶„)</strong><br>
                <div style="margin: 10px 0;">
                    <button class="time-chip" onclick="setTimeValue(3)">3ë¶„</button>
                    <button class="time-chip" onclick="setTimeValue(5)">5ë¶„</button>
                    <button class="time-chip" onclick="setTimeValue(10)">10ë¶„</button>
                    <button class="time-chip" onclick="setTimeValue(30)">20ë¶„</button>
                    <button class="time-chip" onclick="setTimeValue(30)">30ë¶„</button>
                    <button class="time-chip" onclick="setTimeValue(60)">60ë¶„</button>
                </div>

                <div style="display: flex; align-items: center; margin-top: 10px;">
                    <input type="number" id="return-time" class="timer-input" placeholder="ì§ì ‘ ì…ë ¥">
                    <span>ë¶„ í›„ ë³µê·€</span>
                </div>

                <div class="warning-box">
                    <strong>âš ï¸ ì´ìš© ê°€ì´ë“œ</strong><br>
                    - ì‹œê°„ì„ ì •í•˜ê³  ì•„ë˜ ìƒíƒœ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.<br>
                    - ë¯¸ì„¤ì • ì‹œ ë¬´ì œí•œ ìƒíƒœë¡œ ìœ ì§€ë©ë‹ˆë‹¤.<br>
                    - ë¸Œë¼ìš°ì € ì•Œë¦¼ ê¶Œí•œ í—ˆìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
                </div>
            </div>

            <hr style="margin: 25px 0; border: 0; border-top: 1px solid #eee;">

            <h2>ğŸ“ ë¹ ë¥¸ ìƒíƒœ ì„ íƒ</h2>
            <div class="btn-group">
                <button onclick="send('eat', 'ë°¥')">ğŸš ë°¥</button>
                <button onclick="send('toilet', 'í™”ì¥ì‹¤')">ğŸš½ í™”ì¥ì‹¤</button>
                <button onclick="send('coffee', 'ì»¤í”¼')">â˜• ì»¤í”¼</button>
                <button onclick="send('shop', 'ì‡¼í•‘')">ğŸ›’ ì‡¼í•‘</button>
                <button onclick="send('outing', 'ì™¸ì¶œ')">ğŸƒ ì™¸ì¶œ</button>
                <button onclick="send('cigarette', 'ë‹´ë°°')">ğŸš¬ ë‹´ë°°</button>
                <button onclick="send('nap', 'ì ')">ğŸ˜´ ì </button>
                <button onclick="send('back', 'ë³µê·€')" class="btn-back">âœ… ì§€ê¸ˆ ìë¦¬ë¡œ ë³µê·€í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <div class="grid-column">
        <div class="card">
            <h2>âœ¨ ì»¤ìŠ¤í…€ & ê¸°ë¡</h2>
            <div style="margin-bottom: 20px;">
                <label style="font-size: 0.9rem; font-weight: bold;">ë‚˜ë§Œì˜ ìƒíƒœ ì…ë ¥</label>
                <input type="text" id="custom-status" placeholder="íšŒì˜, ì‚°ì±… ë“± ì§ì ‘ ì‘ì„± (Enter)" onkeypress="if(event.keyCode==13) sendCustomStatus()">
                <button class="btn-success" style="width:100%;" onclick="sendCustomStatus()">ìƒíƒœ ì—…ë°ì´íŠ¸</button>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="font-size: 0.9rem; font-weight: bold;">ë©”ì‹œì§€ë§Œ ì „ì†¡</label>
                <input type="text" id="direct-msg" placeholder="ìƒíƒœ ë³€ê²½ ì—†ì´ ë©”ì‹œì§€ë§Œ (Enter)" onkeypress="if(event.keyCode==13) sendDirectMsg()">
                <button class="btn-primary" style="width:100%;" onclick="sendDirectMsg()">ë‹¨ìˆœ ë©”ì‹œì§€ ë³´ë‚´ê¸°</button>
            </div>

            <div class="history-title" style="font-weight: bold; margin-bottom: 5px;">ğŸ“œ í™œë™ ê¸°ë¡</div>
            <div id="status-history"></div>

            <div class="warning-box" style="border-left-color: #5865F2; color: #444; background-color: #f0f3ff;">
                <strong>ğŸ’¡ íŒ</strong><br>
                - ì„¤ì •í•œ ë‹‰ë„¤ì„ì€ ê¸°ê¸°ì— ì €ì¥ë©ë‹ˆë‹¤.<br>
                - ë³µê·€ ë²„íŠ¼ í´ë¦­ ì‹œ íƒ€ì´ë¨¸ê°€ ë¦¬ì…‹ë©ë‹ˆë‹¤.
            </div>
        </div>
    </div>

    <div class="grid-column">
        <div class="card" style="border: 2px solid var(--accent-color);">
            <h2>ğŸ“¡ ì‹¤ì‹œê°„ ìƒíƒœ</h2>
            <div id="status-display">
                <span class="status-icon" id="display-icon">â“</span>
                <span id="display-text">ìƒíƒœë¥¼ ì„ íƒí•˜ë©´<br>ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤!</span>
                <div id="countdown-display" style="display: none;"></div>
            </div>

            <div style="margin-top: auto; padding-top: 20px; border-top: 1px solid #eee;">
                <p style="font-size: 0.8rem; color: #999; line-height: 1.4; text-align: center;">
                    ë””ìŠ¤ì½”ë“œ ì±„ë„ ì•Œë¦¼ê³¼ ì—°ë™ë˜ì–´<br>
                    ì‹¤ì‹œê°„ìœ¼ë¡œ ìƒíƒœê°€ ê³µìœ ë©ë‹ˆë‹¤.
                </p>
            </div>
        </div>
    </div>

</div>

<script>
let countdownInterval;
const DISCORD_WEBHOOK = "https://discord.com/api/webhooks/1458597916955381800/FjIDySDIfP-kZp1udUCL7o6pQN0pv7yJyz0KLiYcLrEm6FyrK10Z5Z9XJnNN0JpRGpxf";

window.onload = function() {
    const savedName = localStorage.getItem('userNickname');
    if (savedName) document.getElementById('nickname').value = savedName;
    if (Notification.permission !== 'granted') Notification.requestPermission();
    restoreStatus();
}

function saveNickname() { localStorage.setItem('userNickname', document.getElementById('nickname').value); }
function toggleTheme() { document.body.classList.toggle('dark-mode'); }
function setTimeValue(min) { document.getElementById('return-time').value = min; }

function getNowFormatted() {
    const now = new Date();
    return `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
}

function sendDirectMsg() {
    const nickname = document.getElementById('nickname').value.trim();
    const content = document.getElementById('direct-msg').value.trim();
    if (!nickname || !content) return alert("ë‹‰ë„¤ì„ê³¼ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
    const timestamp = getNowFormatted();
    fetch(DISCORD_WEBHOOK, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ content: `[${timestamp}] ${nickname}: ğŸ’¬ ${content}` }) });
    addHistoryItem(nickname, `ğŸ’¬ ${content}`, timestamp);
    document.getElementById('direct-msg').value = "";
}

function sendCustomStatus() {
    const text = document.getElementById('custom-status').value.trim();
    if (!text) return alert("ìƒíƒœ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
    send('etc', text);
}

function getUserColor(name) {
    const colors = ['#FF5733', '#27ae60', '#2980b9', '#8e44ad', '#f39c12', '#16a085'];
    return colors[name.length % colors.length];
}

function getActionMessage(action, customText = "") {
    const messages = { eat: "ë°¥ ë¨¹ìœ¼ëŸ¬ ê°”ì–´ìš”!", toilet: "ì ì‹œ í™”ì¥ì‹¤ì— ê°”ì–´ìš”!", coffee: "ì»¤í”¼ í•œ ì” ë§ˆì‹œê³  ì˜¬ê²Œìš”!", shop: "ì ê¹ ì‡¼í•‘í•˜ëŸ¬ ë‚˜ê°”ì–´ìš”!", outing: "ì ì‹œ ì™¸ì¶œ ì¤‘ì´ì—ìš”!", cigarette: "ë‹´ë°° í•œ ëŒ€ í”¼ìš°ê³  ì˜¬ê²Œìš”!", nap: "ê¿€ì  ìëŸ¬ ê°”ì–´ìš”!", back: "ìë¦¬ë¡œ ëŒì•„ì™”ì–´ìš”!", etc: `${customText} ì¤‘ì´ì—ìš”!` };
    return messages[action] || "í™œë™ ì¤‘ì´ì—ìš”!";
}

function send(action, statusName) {
    const nickname = document.getElementById('nickname').value.trim();
    const returnTimeValue = document.getElementById('return-time').value.trim();
    const returnTime = returnTimeValue ? parseInt(returnTimeValue) : null;
    if (!nickname) { alert("ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!"); return; }

    clearInterval(countdownInterval);
    document.getElementById('countdown-display').style.display = "none";

    const icons = { eat: "ğŸš", toilet: "ğŸš½", back: "âœ…", coffee: "â˜•", shop: "ğŸ›’", outing: "ğŸƒ", cigarette: "ğŸš¬", nap: "ğŸ˜´", etc: "âœ¨" };
    const icon = icons[action] || "ğŸ“";
    const statusMsg = getActionMessage(action, statusName);
    const timeInfo = (returnTime && action !== 'back') ? ` [${returnTime}ë¶„ ë’¤ ë³µê·€ ì˜ˆì •]` : "";
    const fullMsg = `${statusMsg}${timeInfo}`;
    const timestamp = getNowFormatted();

    fetch(DISCORD_WEBHOOK, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ content: `[${timestamp}] ${nickname}ë‹˜ì´ ${icon} ${fullMsg}` }) });

    updateUI(nickname, icon, statusName, timestamp, fullMsg);

    if (action !== 'back') {
        const expireTime = returnTime ? Date.now() + (returnTime * 60000) : null;
        localStorage.setItem('currentStatus', JSON.stringify({ nickname, icon, statusName, expireTime }));
        if (returnTime) {
            document.getElementById('countdown-display').style.display = "block";
            startTimer(returnTime * 60);
        }
    } else {
        localStorage.removeItem('currentStatus');
        document.getElementById('return-time').value = "";
    }
}

function updateUI(nickname, icon, statusName, timestamp, msg) {
    const userColor = getUserColor(nickname);
    document.getElementById('display-icon').innerText = icon;
    document.getElementById('display-text').innerHTML = `
        <span style="color:${userColor}; font-size:1.1rem;">${nickname}</span><br>
        <span style="color:#e74c3c;">[${statusName}]</span> ì¤‘<br>
        <small style="font-size: 0.85rem; color: #777; font-weight:normal;">(${msg})</small>
    `;
    addHistoryItem(nickname, msg, timestamp);
}

function addHistoryItem(nickname, msg, timestamp) {
    const historyBox = document.getElementById('status-history');
    const newRecord = `<div class="history-item"><small style="color:gray;">${timestamp}</small> <strong>${nickname}</strong>: ${msg}</div>`;
    historyBox.innerHTML = newRecord + historyBox.innerHTML;
}

function startTimer(secondsTotal) {
    let secondsLeft = Math.floor(secondsTotal);
    countdownInterval = setInterval(() => {
        secondsLeft--;
        if (secondsLeft <= 0) {
            clearInterval(countdownInterval);
            if (Notification.permission === 'granted') new Notification("ë³µê·€ ì•Œë¦¼", { body: "ë³µê·€ ì‹œê°„ì´ ë˜ì—ˆìŠµë‹ˆë‹¤!" });
            send('back', 'ìë™ ë³µê·€');
            return;
        }
        const m = Math.floor(secondsLeft / 60);
        const s = secondsLeft % 60;
        document.getElementById('countdown-display').innerText = `â³ ë³µê·€ê¹Œì§€ ${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')} ë‚¨ìŒ`;
    }, 1000);
}

function restoreStatus() {
    const data = localStorage.getItem('currentStatus');
    if (!data) return;
    const { nickname, icon, statusName, expireTime } = JSON.parse(data);
    const now = Date.now();
    if (expireTime && now > expireTime) { localStorage.removeItem('currentStatus'); return; }
    updateUI(nickname, icon, statusName, getNowFormatted(), "ìƒíƒœ ë³µêµ¬ë¨");
    if (expireTime) {
        document.getElementById('countdown-display').style.display = "block";
        startTimer((expireTime - now) / 1000);
    }
}
</script>
</body>
</html>